import React, { useEffect, useState, useRef } from 'react'
import { gsap } from 'gsap'
import styled from 'styled-components'
import LogoSVG from '../../../images/metamask-logo.svg'

/**
 * @name PortfolioLoader
 * @summary -
 * @description - Portfolio page - Loader
 */

const PortfolioLoader = props => {
  const { canvasHandleReady, setShowLoader, setShowIntro } = props
  const wrapper = useRef()
  const logo = useRef()
  const logoIso = useRef()
  const logoText = useRef()

  const animateOut = onCompleteFn => {
    gsap
      .timeline({
        defaults: {
          ease: 'mm-ease-1', //ease-lb
        },
      })
      .timeScale(1.15)
      .to(
        logoIso.current,
        {
          x: 0,
          duration: 0.75,
        },
        0
      )
      .to(
        logoText.current,
        {
          autoAlpha: 1,
          duration: 0.5,
        },
        0.5
      )
      .to(
        logo.current,
        {
          opacity: 0,
          duration: 0.5,
          onComplete: () => setShowIntro(true),
        },
        1.8
      )
      .fromTo(
        wrapper.current,
        { '--circle-pos': '0%' },
        {
          duration: 1,
          '--circle-pos': '100%',
          onComplete: () => onCompleteFn && onCompleteFn(),
        }
      )
  }

  const onCompleteFn = () => {
    setShowLoader(false)
  }

  useEffect(() => {
    canvasHandleReady && animateOut(onCompleteFn)
  }, [canvasHandleReady])

  return (
    <Wrapper ref={wrapper} style={{ '--circle-pos': '0%' }}>
      <div
        style={{
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'center',
        }}
      >
        <Logo ref={logo}>
          <LogoSvgWrapper ref={logoIso}>
            <LogoSVG />
          </LogoSvgWrapper>

          <LogoText ref={logoText}>
            <Divider />
            <LogoTextSvg>
              <svg
                width="104"
                height="22"
                viewBox="0 0 104 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M13.7165 7.86946C13.7165 8.76651 13.5536 9.60192 13.2312 10.3689C12.9055 11.1358 12.4508 11.8069 11.8672 12.3752C11.2836 12.947 10.5677 13.3921 9.72619 13.7071C8.88131 14.0255 7.94822 14.183 6.9303 14.183H3.47954V21.4552H0.890625V1.52512H6.9269C7.94822 1.52512 8.87792 1.68946 9.72279 2.01472C10.5677 2.34341 11.2802 2.78851 11.8638 3.35002C12.4474 3.91152 12.9021 4.57917 13.2278 5.35638C13.5536 6.13358 13.7131 6.969 13.7131 7.86946H13.7165ZM11.1581 7.86946C11.1581 7.30796 11.0665 6.79438 10.8798 6.32532C10.6932 5.85625 10.4218 5.4454 10.0587 5.08932C9.69564 4.73324 9.25456 4.45933 8.73881 4.26075C8.21967 4.06559 7.6157 3.9663 6.9303 3.9663H3.47954V11.7726H6.9303C7.6157 11.7726 8.21967 11.6733 8.73881 11.4782C9.25795 11.283 9.69904 11.0057 10.0587 10.6496C10.4218 10.2935 10.6932 9.88267 10.8798 9.41361C11.0631 8.94454 11.1581 8.43097 11.1581 7.86946Z"
                  fill="white"
                />
                <path
                  d="M21.5495 21.7429C20.4909 21.7429 19.5171 21.5512 18.6281 21.1677C17.7391 20.7843 16.9689 20.2639 16.3174 19.6099C15.6693 18.9559 15.1638 18.1822 14.8007 17.2954C14.4376 16.4052 14.2578 15.4568 14.2578 14.4468C14.2578 13.4367 14.4376 12.4849 14.8007 11.5982C15.1638 10.708 15.6659 9.9376 16.3174 9.28365C16.9689 8.6297 17.7357 8.10927 18.6281 7.72581C19.5171 7.34234 20.4909 7.1506 21.5495 7.1506C22.6082 7.1506 23.5514 7.34234 24.4438 7.72581C25.3328 8.10927 26.103 8.6297 26.7545 9.28365C27.4026 9.9376 27.9082 10.7114 28.2712 11.5982C28.6343 12.4883 28.8141 13.4367 28.8141 14.4468C28.8141 15.4568 28.6343 16.4086 28.2712 17.2954C27.9082 18.1856 27.4026 18.9559 26.7545 19.6099C26.1064 20.2639 25.3362 20.7843 24.4438 21.1677C23.5548 21.5512 22.5878 21.7429 21.5495 21.7429ZM21.5495 19.4969C22.2723 19.4969 22.9305 19.3668 23.5243 19.1032C24.1181 18.843 24.6237 18.48 25.041 18.0212C25.4583 17.5625 25.7841 17.0283 26.0148 16.4223C26.2455 15.8129 26.3643 15.1555 26.3643 14.4434C26.3643 13.7312 26.2489 13.0944 26.0148 12.4781C25.7841 11.8618 25.4583 11.3242 25.041 10.8655C24.6237 10.4067 24.1181 10.0472 23.5243 9.78352C22.9305 9.51989 22.2723 9.38978 21.5495 9.38978C20.8268 9.38978 20.1685 9.51989 19.5748 9.78352C18.981 10.0472 18.472 10.4067 18.0445 10.8655C17.6169 11.3242 17.2878 11.8618 17.0571 12.4781C16.8264 13.0944 16.711 13.7517 16.711 14.4434C16.711 15.135 16.8264 15.8163 17.0571 16.4223C17.2878 17.0318 17.6169 17.5625 18.0445 18.0212C18.472 18.48 18.981 18.8395 19.5748 19.1032C20.1685 19.3668 20.8268 19.4969 21.5495 19.4969Z"
                  fill="white"
                />
                <path
                  d="M30.8789 7.42639H33.271V10.1483C33.4 9.69981 33.6035 9.2958 33.8818 8.93972C34.16 8.58364 34.4756 8.28577 34.8285 8.04268C35.1813 7.79958 35.5546 7.61127 35.9549 7.48117C36.3519 7.35106 36.7557 7.28601 37.1663 7.28601C37.5361 7.28601 37.8992 7.32367 38.2521 7.399V9.89839C38.0281 9.80594 37.8143 9.74432 37.6108 9.71693C37.4072 9.68954 37.1832 9.67584 36.9423 9.67584C36.4978 9.67584 36.0567 9.77513 35.6224 9.97029C35.1847 10.1654 34.7979 10.4633 34.4552 10.8536C34.1125 11.2474 33.8309 11.7473 33.6069 12.3567C33.383 12.9661 33.2744 13.6817 33.2744 14.5034V21.4675H30.8823V7.42981L30.8789 7.42639Z"
                  fill="white"
                />
                <path
                  d="M46.7894 21.6099C46.1787 21.6099 45.612 21.5209 45.0929 21.3428C44.5738 21.1648 44.1225 20.9046 43.7425 20.5554C43.3624 20.2096 43.0638 19.7645 42.8535 19.2235C42.6397 18.6825 42.5345 18.0457 42.5345 17.313V9.64707H39.5859V7.42843H42.5345V3.52527H44.9266V7.42843H48.9339V9.64707H44.9266V17.0014C44.9266 17.8985 45.12 18.5216 45.5102 18.8674C45.9004 19.2132 46.4739 19.3878 47.2339 19.3878C47.5291 19.3878 47.8311 19.3639 48.1399 19.3159C48.4452 19.268 48.7099 19.1995 48.9339 19.1037V21.2641C48.6353 21.3565 48.3129 21.4387 47.96 21.5038C47.6072 21.5688 47.217 21.6031 46.7928 21.6031L46.7894 21.6099Z"
                  fill="white"
                />
                <path
                  d="M53.1595 9.64201H50.2109V7.42337H53.1595V4.58844C53.1595 3.85917 53.2647 3.22234 53.4785 2.67795C53.6922 2.13698 53.9874 1.68161 54.3675 1.31527C54.7475 0.948917 55.1988 0.678434 55.7179 0.500395C56.237 0.322356 56.8037 0.233337 57.4144 0.233337C57.842 0.233337 58.2322 0.267575 58.5817 0.332628C58.9345 0.397681 59.2671 0.4867 59.5826 0.599687V2.73273C59.3587 2.64029 59.0872 2.56839 58.7615 2.52045C58.4357 2.47252 58.1338 2.44855 57.8555 2.44855C57.0751 2.44855 56.4949 2.62317 56.1183 2.96897C55.7383 3.31478 55.5482 3.93791 55.5482 4.83496V7.41652H59.5826V9.63516H55.5482V21.4542H53.1561V9.63516L53.1595 9.64201Z"
                  fill="white"
                />
                <path
                  d="M68.0261 21.7429C66.9675 21.7429 65.9936 21.5512 65.1047 21.1677C64.2157 20.7843 63.4454 20.2639 62.794 19.6099C62.1459 18.9559 61.6403 18.1822 61.2773 17.2954C60.9142 16.4052 60.7344 15.4568 60.7344 14.4468C60.7344 13.4367 60.9142 12.4849 61.2773 11.5982C61.6403 10.708 62.1425 9.9376 62.794 9.28365C63.4454 8.6297 64.2123 8.10927 65.1047 7.72581C65.9936 7.34234 66.9675 7.1506 68.0261 7.1506C69.0847 7.1506 70.028 7.34234 70.9204 7.72581C71.8094 8.10927 72.5796 8.6297 73.2311 9.28365C73.8792 9.9376 74.3847 10.7114 74.7478 11.5982C75.1108 12.4883 75.2907 13.4367 75.2907 14.4468C75.2907 15.4568 75.1108 16.4086 74.7478 17.2954C74.3847 18.1856 73.8792 18.9559 73.2311 19.6099C72.583 20.2639 71.8128 20.7843 70.9204 21.1677C70.0314 21.5512 69.0644 21.7429 68.0261 21.7429ZM68.0261 19.4969C68.7488 19.4969 69.4071 19.3668 70.0009 19.1032C70.5947 18.843 71.1002 18.48 71.5176 18.0212C71.9349 17.5625 72.2606 17.0283 72.4914 16.4223C72.7221 15.8129 72.8409 15.1555 72.8409 14.4434C72.8409 13.7312 72.7255 13.0944 72.4914 12.4781C72.2606 11.8618 71.9349 11.3242 71.5176 10.8655C71.1002 10.4067 70.5947 10.0472 70.0009 9.78352C69.4071 9.51989 68.7488 9.38978 68.0261 9.38978C67.3034 9.38978 66.6451 9.51989 66.0513 9.78352C65.4575 10.0472 64.9486 10.4067 64.521 10.8655C64.0935 11.3242 63.7644 11.8618 63.5337 12.4781C63.3029 13.0944 63.1876 13.7517 63.1876 14.4434C63.1876 15.135 63.3029 15.8163 63.5337 16.4223C63.7644 17.0318 64.0935 17.5625 64.521 18.0212C64.9486 18.48 65.4575 18.8395 66.0513 19.1032C66.6451 19.3668 67.3034 19.4969 68.0261 19.4969Z"
                  fill="white"
                />
                <path
                  d="M78.0273 0.410431H80.4195V21.467H78.0273V0.410431Z"
                  fill="white"
                />
                <path
                  d="M85.5044 3.66401C85.0226 3.66401 84.6154 3.49967 84.2795 3.17098C83.947 2.84229 83.7773 2.43828 83.7773 1.94867C83.7773 1.45907 83.9436 1.07902 84.2795 0.740063C84.6154 0.401105 85.0226 0.233337 85.5044 0.233337C85.9862 0.233337 86.3866 0.401105 86.7022 0.740063C87.0177 1.0756 87.1738 1.47961 87.1738 1.94867C87.1738 2.41774 87.0177 2.84229 86.7022 3.17098C86.3866 3.49967 85.9862 3.66401 85.5044 3.66401ZM84.2795 7.42679H86.6716V21.4645H84.2795V7.42679Z"
                  fill="white"
                />
                <path
                  d="M96.7019 21.7429C95.6432 21.7429 94.6694 21.5512 93.7804 21.1677C92.8914 20.7843 92.1212 20.2639 91.4697 19.6099C90.8217 18.9559 90.3161 18.1822 89.953 17.2954C89.59 16.4052 89.4102 15.4568 89.4102 14.4468C89.4102 13.4367 89.59 12.4849 89.953 11.5982C90.3161 10.708 90.8183 9.9376 91.4697 9.28365C92.1212 8.6297 92.888 8.10927 93.7804 7.72581C94.6694 7.34234 95.6432 7.1506 96.7019 7.1506C97.7605 7.1506 98.7038 7.34234 99.5962 7.72581C100.485 8.10927 101.255 8.6297 101.907 9.28365C102.555 9.9376 103.06 10.7114 103.424 11.5982C103.787 12.4883 103.966 13.4367 103.966 14.4468C103.966 15.4568 103.787 16.4086 103.424 17.2954C103.06 18.1856 102.555 18.9559 101.907 19.6099C101.259 20.2639 100.489 20.7843 99.5962 21.1677C98.7072 21.5512 97.7402 21.7429 96.7019 21.7429ZM96.7019 19.4969C97.4246 19.4969 98.0829 19.3668 98.6766 19.1032C99.2704 18.843 99.776 18.48 100.193 18.0212C100.611 17.5625 100.936 17.0283 101.167 16.4223C101.398 15.8129 101.517 15.1555 101.517 14.4434C101.517 13.7312 101.401 13.0944 101.167 12.4781C100.936 11.8618 100.611 11.3242 100.193 10.8655C99.776 10.4067 99.2704 10.0472 98.6766 9.78352C98.0829 9.51989 97.4246 9.38978 96.7019 9.38978C95.9791 9.38978 95.3209 9.51989 94.7271 9.78352C94.1333 10.0472 93.6243 10.4067 93.1968 10.8655C92.7693 11.3242 92.4402 11.8618 92.2094 12.4781C91.9787 13.0944 91.8633 13.7517 91.8633 14.4434C91.8633 15.135 91.9787 15.8163 92.2094 16.4223C92.4402 17.0318 92.7693 17.5625 93.1968 18.0212C93.6243 18.48 94.1333 18.8395 94.7271 19.1032C95.3209 19.3668 95.9791 19.4969 96.7019 19.4969Z"
                  fill="white"
                />
              </svg>
            </LogoTextSvg>
          </LogoText>
        </Logo>
      </div>
    </Wrapper>
  )
}

export default PortfolioLoader

const Wrapper = styled.div`
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  //background-color: #34244c;

  background: radial-gradient(
    circle at 50% 50%,
    rgba(0, 0, 0, 0) var(--circle-pos),
    #503875 var(--circle-pos)
  );
  z-index: 50;

  @media (max-width: ${({ theme }) => theme.device.miniDesktop}) {
    height: 100svh;
  }
`

const Logo = styled.div`
  position: relative;
  display: flex;
  column-gap: 15px;
  align-items: center;

  svg {
    path {
      &:nth-child(1) {
        fill: #ffffff;
      }
    }
  }
`

const LogoSvgWrapper = styled.div`
  transform: translateX(54px);
  line-height: 0;

  svg {
    width: 163px;
  }
`

const LogoText = styled.div`
  display: flex;
  column-gap: 15px;
  align-items: center;
  color: #ffffff;
  opacity: 0;
`

const Divider = styled.div`
  width: 2px;
  height: 22px;
  background-color: #ffffff;
`

const LogoTextSvg = styled.div`
  line-height: 0;

  svg {
    width: 75px;
    height: 17px;
  }
`
