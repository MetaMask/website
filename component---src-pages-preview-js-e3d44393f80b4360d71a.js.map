{"version":3,"file":"component---src-pages-preview-js-e3d44393f80b4360d71a.js","mappings":"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","sources":["webpack://metamask-io/./src/components/PreviewLoading/index.js","webpack://metamask-io/./src/pages/preview.js"],"sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\n\nconst PreviewLoading = () => {\n  return (\n    <Wrapper>\n      <svg\n        version=\"1.1\"\n        id=\"Layer_1\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        x=\"0px\"\n        y=\"0px\"\n        width=\"48px\"\n        height=\"60px\"\n        viewBox=\"0 0 24 30\"\n        xmlSpace=\"preserve\"\n      >\n        <rect x=\"0\" y=\"13\" width=\"4\" height=\"5\" fill=\"#333\">\n          <animate\n            attributeName=\"height\"\n            attributeType=\"XML\"\n            values=\"5;21;5\"\n            begin=\"0s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n          <animate\n            attributeName=\"y\"\n            attributeType=\"XML\"\n            values=\"13; 5; 13\"\n            begin=\"0s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n        </rect>\n        <rect x=\"10\" y=\"13\" width=\"4\" height=\"5\" fill=\"#333\">\n          <animate\n            attributeName=\"height\"\n            attributeType=\"XML\"\n            values=\"5;21;5\"\n            begin=\"0.15s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n          <animate\n            attributeName=\"y\"\n            attributeType=\"XML\"\n            values=\"13; 5; 13\"\n            begin=\"0.15s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n        </rect>\n        <rect x=\"20\" y=\"13\" width=\"4\" height=\"5\" fill=\"#333\">\n          <animate\n            attributeName=\"height\"\n            attributeType=\"XML\"\n            values=\"5;21;5\"\n            begin=\"0.3s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n          <animate\n            attributeName=\"y\"\n            attributeType=\"XML\"\n            values=\"13; 5; 13\"\n            begin=\"0.3s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n        </rect>\n      </svg>\n    </Wrapper>\n  )\n}\n\nconst Wrapper = styled.div`\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  padding-top: 20vh;\n  svg path,\n  svg rect {\n    fill: #f58420;\n  }\n`\n\nexport default PreviewLoading\n","import qs from 'query-string'\nimport React from 'react'\nimport styled from 'styled-components'\nimport PreviewLoading from '../components/PreviewLoading'\nimport {\n  convertContentfulPreviewTypename,\n  fetchContentfulData,\n  fetchContentfulTypename,\n} from '../lib/utils/fetchContentfulData'\nimport { contentfulModuleToComponent } from '../lib/utils/moduleToComponent'\nimport Layout from '../templates/PageLayout'\n\nclass PreviewPage extends React.Component {\n  state = {\n    loading: true,\n    moduleConfig: null,\n    error: null,\n  }\n\n  componentDidMount() {\n    this.getModule()\n  }\n\n  getModule = async () => {\n    const { location } = this.props\n    const queryParams = qs.parse(location.search ?? '')\n    const id = queryParams.module_id\n\n    if (queryParams.environment && queryParams.environment === 'master') {\n      delete queryParams.environment\n      return (window.location.href = `https://metamask.io${\n        location.pathname\n      }?${qs.stringify(queryParams)}`)\n    }\n\n    try {\n      if (!id) {\n        this.setState({\n          loading: false,\n          error: {\n            message: 'No module id provided to preview',\n          },\n        })\n        return\n      }\n\n      const type = await fetchContentfulTypename(id)\n      if (!type) {\n        this.setState({\n          loading: false,\n          error: {\n            message: 'Failed to fetch contentful type name',\n          },\n        })\n        return\n      }\n\n      const { data } = await fetchContentfulData(type, id)\n      if (data) {\n        const contentType = data.previewContent?.__typename\n        const contentId = data.previewContent?.sys.id || undefined\n        const dataUpdate = {\n          ...data.previewContent,\n          internal: {\n            type: convertContentfulPreviewTypename(contentType),\n          },\n          contentful_id: contentId,\n        }\n        this.setState({\n          loading: false,\n          moduleConfig: dataUpdate,\n        })\n        return\n      }\n    } catch (error) {\n      console.log('Fetch preview data error: ', error)\n    }\n\n    this.setState({\n      loading: false,\n      error: {\n        message: 'Failed to fetch preview data',\n      },\n    })\n  }\n\n  render() {\n    const { loading, moduleConfig, error } = this.state\n\n    if (loading) return <PreviewLoading />\n    if (moduleConfig) {\n      return (\n        <Layout\n          themeColor={moduleConfig.themeColor}\n          h2FontSize={moduleConfig.h2FontSize}\n        >\n          <PreviewInfo>Preview mode</PreviewInfo>\n          {contentfulModuleToComponent(moduleConfig)}\n        </Layout>\n      )\n    }\n    return <h4>Failed to load preview component: {error?.message}</h4>\n  }\n}\n\nconst PreviewInfo = styled.div`\n  width: 140px;\n  height: 35px;\n  background-color: lightyellow;\n  color: red;\n  text-align: center;\n  line-height: 31px;\n  font-weight: bold;\n  border: 2px solid lightgoldenrodyellow;\n  border-radius: 10px 10px 0 0;\n  position: fixed;\n  top: 200px;\n  left: -53px;\n  z-index: 2000;\n  transform: rotate(90deg);\n`\n\nexport default PreviewPage\n"],"names":["Wrapper","styled","displayName","componentId","React","version","id","xmlns","xmlnsXlink","x","y","width","height","viewBox","xmlSpace","fill","attributeName","attributeType","values","begin","dur","repeatCount","PreviewPage","_React$Component","_this","_len","arguments","length","args","Array","_key","call","state","loading","moduleConfig","error","getModule","_asyncToGenerator","_regeneratorRuntime","_callee","_location$search","location","queryParams","type","_yield$fetchContentfu","data","_data$previewContent","_data$previewContent2","contentType","contentId","dataUpdate","_context","prev","next","props","qs","search","module_id","environment","abrupt","window","href","pathname","setState","message","fetchContentfulTypename","sent","fetchContentfulData","previewContent","__typename","sys","undefined","Object","assign","internal","convertContentfulPreviewTypename","contentful_id","t0","console","log","stop","_inheritsLoose","_proto","prototype","componentDidMount","this","render","_this$state","PreviewLoading","Layout","themeColor","h2FontSize","PreviewInfo","contentfulModuleToComponent"],"sourceRoot":""}