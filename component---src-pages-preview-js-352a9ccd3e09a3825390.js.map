{"version":3,"file":"component---src-pages-preview-js-352a9ccd3e09a3825390.js","mappings":"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","sources":["webpack://metamask-io/./src/components/PreviewLoading/index.js","webpack://metamask-io/./src/pages/preview.js"],"sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\n\nconst PreviewLoading = () => {\n  return (\n    <Wrapper>\n      <svg\n        version=\"1.1\"\n        id=\"Layer_1\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        x=\"0px\"\n        y=\"0px\"\n        width=\"48px\"\n        height=\"60px\"\n        viewBox=\"0 0 24 30\"\n        xmlSpace=\"preserve\"\n      >\n        <rect x=\"0\" y=\"13\" width=\"4\" height=\"5\" fill=\"#24292E\">\n          <animate\n            attributeName=\"height\"\n            attributeType=\"XML\"\n            values=\"5;21;5\"\n            begin=\"0s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n          <animate\n            attributeName=\"y\"\n            attributeType=\"XML\"\n            values=\"13; 5; 13\"\n            begin=\"0s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n        </rect>\n        <rect x=\"10\" y=\"13\" width=\"4\" height=\"5\" fill=\"#24292E\">\n          <animate\n            attributeName=\"height\"\n            attributeType=\"XML\"\n            values=\"5;21;5\"\n            begin=\"0.15s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n          <animate\n            attributeName=\"y\"\n            attributeType=\"XML\"\n            values=\"13; 5; 13\"\n            begin=\"0.15s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n        </rect>\n        <rect x=\"20\" y=\"13\" width=\"4\" height=\"5\" fill=\"#24292E\">\n          <animate\n            attributeName=\"height\"\n            attributeType=\"XML\"\n            values=\"5;21;5\"\n            begin=\"0.3s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n          <animate\n            attributeName=\"y\"\n            attributeType=\"XML\"\n            values=\"13; 5; 13\"\n            begin=\"0.3s\"\n            dur=\"0.6s\"\n            repeatCount=\"indefinite\"\n          />\n        </rect>\n      </svg>\n    </Wrapper>\n  )\n}\n\nconst Wrapper = styled.div`\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  padding-top: 20vh;\n  svg path,\n  svg rect {\n    fill: #f58420;\n  }\n`\n\nexport default PreviewLoading\n","import qs from 'query-string'\nimport React, { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport PreviewLoading from '../components/PreviewLoading'\nimport ContextClientSide from '../Context/ContextClientSide'\nimport {\n  convertContentfulPreviewTypename,\n  fetchContentfulData,\n  fetchContentfulTypename,\n} from '../lib/utils/fetchContentfulData'\nimport { contentfulModuleToComponent } from '../lib/utils/moduleToComponent'\nimport Layout from '../templates/PageLayout'\nimport ContentfulPortfolioLayout from '../templates/ContentfulPortfolioLayout'\nimport { DEFAULT_LOCALE } from '../lib/config.mjs'\n\nconst PreviewPage = () => {\n  const [loading, setLoading] = useState(true)\n  const [moduleConfig, setModuleConfig] = useState(null)\n  const [error, setError] = useState(null)\n  const [locale, setLocale] = useState(DEFAULT_LOCALE)\n\n  const getModule = async () => {\n    const { location } = window\n    const queryParams = qs.parse(location.search ?? '')\n    const id = queryParams.module_id\n\n    if (queryParams.environment && queryParams.environment === 'master') {\n      delete queryParams.environment\n      return (window.location.href = `https://metamask.io${\n        location.pathname\n      }?${qs.stringify(queryParams)}`)\n    }\n\n    try {\n      if (!id) {\n        setLoading(false)\n        setError({\n          message: 'No module id provided to preview',\n        })\n        return\n      }\n\n      const type = await fetchContentfulTypename(id)\n      if (!type) {\n        setLoading(false)\n        setError({\n          message: 'Failed to fetch contentful type name',\n        })\n        return\n      }\n\n      const { data } = await fetchContentfulData(type, id, locale.code)\n      if (data) {\n        const contentType = data.previewContent?.__typename\n        const contentId = data.previewContent?.sys.id || undefined\n        const dataUpdate = {\n          ...data.previewContent,\n          internal: {\n            type: convertContentfulPreviewTypename(contentType),\n          },\n          contentful_id: contentId,\n        }\n        setLoading(false)\n        setModuleConfig(dataUpdate)\n        return\n      }\n    } catch (error) {\n      console.log('Fetch preview data error: ', error)\n    }\n    setLoading(false)\n    setError({\n      message: 'Failed to fetch preview data',\n    })\n  }\n\n  useEffect(() => {\n    setLoading(true)\n    getModule()\n  }, [locale])\n\n  if (loading) return <PreviewLoading />\n  if (moduleConfig?.slug === '/portfolio/') {\n    return <ContentfulPortfolioLayout data={moduleConfig} />\n  }\n  if (moduleConfig) {\n    return (\n      <ContextClientSide.Provider\n        value={{\n          localization: {\n            locale,\n            setLocale,\n          },\n        }}\n      >\n        <Layout\n          themeColor={moduleConfig?.themeColor}\n          h2FontSize={moduleConfig?.h2FontSize}\n          widerContainer={moduleConfig?.widerContainer}\n          locale={locale.code}\n        >\n          <PreviewInfo>Preview mode</PreviewInfo>\n          {contentfulModuleToComponent(moduleConfig)}\n        </Layout>\n      </ContextClientSide.Provider>\n    )\n  }\n  return <h4>Failed to load preview component: {error?.message}</h4>\n}\n\nconst PreviewInfo = styled.div`\n  width: 140px;\n  height: 35px;\n  background-color: lightyellow;\n  color: red;\n  text-align: center;\n  line-height: 31px;\n  font-weight: bold;\n  border: 2px solid lightgoldenrodyellow;\n  border-radius: 10px 10px 0 0;\n  position: fixed;\n  top: 200px;\n  left: -53px;\n  z-index: 2000;\n  transform: rotate(90deg);\n`\n\nexport default PreviewPage\n"],"names":["Wrapper","styled","div","withConfig","displayName","componentId","PreviewLoading","React","version","id","xmlns","xmlnsXlink","x","y","width","height","viewBox","xmlSpace","fill","attributeName","attributeType","values","begin","dur","repeatCount","PreviewInfo","PreviewPage","loading","setLoading","useState","moduleConfig","setModuleConfig","error","setError","locale","setLocale","DEFAULT_LOCALE","useEffect","async","_location$search","location","window","queryParams","qs","search","module_id","environment","href","pathname","message","type","fetchContentfulTypename","data","fetchContentfulData","code","_data$previewContent","_data$previewContent2","contentType","previewContent","__typename","contentId","sys","undefined","dataUpdate","internal","convertContentfulPreviewTypename","contentful_id","console","log","getModule","slug","ContentfulPortfolioLayout","ContextClientSide","Provider","value","localization","Layout","themeColor","h2FontSize","widerContainer","contentfulModuleToComponent"],"sourceRoot":""}